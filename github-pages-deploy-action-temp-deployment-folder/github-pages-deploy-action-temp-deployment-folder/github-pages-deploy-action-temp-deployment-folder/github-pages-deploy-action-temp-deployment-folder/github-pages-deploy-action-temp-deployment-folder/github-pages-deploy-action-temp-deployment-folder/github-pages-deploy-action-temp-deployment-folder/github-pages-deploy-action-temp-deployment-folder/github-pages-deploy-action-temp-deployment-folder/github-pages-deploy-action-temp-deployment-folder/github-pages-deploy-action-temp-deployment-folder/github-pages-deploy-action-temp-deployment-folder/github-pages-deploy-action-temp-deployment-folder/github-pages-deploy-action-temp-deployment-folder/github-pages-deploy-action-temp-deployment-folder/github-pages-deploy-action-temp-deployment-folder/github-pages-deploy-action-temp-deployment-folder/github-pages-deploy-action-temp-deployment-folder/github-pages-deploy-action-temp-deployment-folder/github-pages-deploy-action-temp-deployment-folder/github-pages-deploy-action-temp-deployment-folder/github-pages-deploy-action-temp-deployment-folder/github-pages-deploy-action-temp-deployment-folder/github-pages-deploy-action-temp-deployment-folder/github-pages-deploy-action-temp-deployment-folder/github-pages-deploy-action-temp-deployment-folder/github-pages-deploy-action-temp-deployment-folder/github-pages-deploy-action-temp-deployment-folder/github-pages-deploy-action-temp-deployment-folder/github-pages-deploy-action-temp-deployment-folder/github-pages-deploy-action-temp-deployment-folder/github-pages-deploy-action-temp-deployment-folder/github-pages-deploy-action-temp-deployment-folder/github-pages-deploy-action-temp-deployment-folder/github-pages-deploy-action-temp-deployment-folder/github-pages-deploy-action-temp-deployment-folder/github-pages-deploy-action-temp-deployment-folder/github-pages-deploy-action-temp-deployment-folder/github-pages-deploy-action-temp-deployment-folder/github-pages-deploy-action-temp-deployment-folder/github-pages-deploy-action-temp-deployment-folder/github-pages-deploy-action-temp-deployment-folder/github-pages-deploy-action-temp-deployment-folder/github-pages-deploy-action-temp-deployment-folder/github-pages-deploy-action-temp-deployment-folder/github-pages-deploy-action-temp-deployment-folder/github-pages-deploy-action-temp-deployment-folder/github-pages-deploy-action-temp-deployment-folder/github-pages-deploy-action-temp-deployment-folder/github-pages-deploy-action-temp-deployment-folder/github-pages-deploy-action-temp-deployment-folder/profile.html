<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حسابي - CourseHub</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- Page-specific styling --- */
.profile-container {
    max-width: 600px;
    margin: 50px auto;
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.profile-container h2 {
    text-align: center;
    color: #0056d2;
    margin-bottom: 30px;
}

.profile-pic {
    display: block;
    margin: 0 auto 20px;
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #ff9900;
}

.profile-form label {
    font-weight: bold;
    margin-top: 10px;
}

.profile-form input {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
}

.profile-form button {
    background-color: #ff9900;
    color: #fff;
    padding: 12px 20px;
    margin-top: 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
}

.profile-form button:hover {
    background-color: #e68a00;
}

.logout-btn {
    background-color: #c0392b;
    margin-top: 10px;
}

.logout-btn:hover {
    background-color: #a83224;
}

@media(max-width:768px){
    .profile-container { margin: 20px; padding: 20px; }
    .profile-pic { width: 100px; height: 100px; }
}
</style>
</head>
<body>

<header>
  <div class="top-bar container">
    <div class="logo">
      <img src="images/logo.png" alt="CourseHub Logo" class="site-logo" style="width:120px;">
    </div>
    <nav>
      <a href="index.html">الرئيسية</a>
      <a href="courses.html">الدورات</a>
      <a href="tests.html">الاختبارات</a>
      <a href="certificates.html">الشهادات</a>
      <a href="login.html" id="login-link">تسجيل الدخول</a>
    </nav>
    <div id="user-info" class="user-info-container"></div>
  </div>
</header>

<section class="profile-container">
  <h2>حسابي الشخصي</h2>
  <img src="" alt="Profile Picture" id="profile-pic" class="profile-pic">

  <form id="profile-form" class="profile-form">
    <label for="name">الاسم الكامل</label>
    <input type="text" id="name" required>

    <label for="email">البريد الإلكتروني</label>
    <input type="email" id="email" disabled>

    <label for="picture">رابط صورة الملف الشخصي</label>
    <input type="text" id="picture">

    <button type="submit">حفظ التغييرات</button>
  </form>

  <button class="logout-btn" onclick="logout()">تسجيل الخروج</button>
</section>

<script>
// حماية الصفحة للمستخدمين فقط
const user = JSON.parse(localStorage.getItem("coursehub_user"));
if(!user){
    alert('يجب تسجيل الدخول للوصول لهذه الصفحة');
    window.location.href = 'login.html';
}

// عرض بيانات المستخدم الحالية
if(user){
    document.getElementById('login-link').style.display = 'none';
    document.getElementById('footer-login')?.style.display = 'none';
    document.getElementById('user-info').innerHTML = `
      <div class="user-dropdown">
        <img src="${user.picture}" alt="${user.name}" class="user-pic">
        <span>${user.name}</span>
        <div class="dropdown-menu">
          <a href="profile.html">حسابي</a>
          <a href="#" onclick="logout()">تسجيل الخروج</a>
        </div>
      </div>
    `;

    document.getElementById('profile-pic').src = user.picture;
    document.getElementById('name').value = user.name;
    document.getElementById('email').value = user.email;
    document.getElementById('picture').value = user.picture;
}

// حفظ التغييرات
document.getElementById('profile-form').addEventListener('submit', function(e){
    e.preventDefault();
    const updatedUser = {
        name: document.getElementById('name').value,
        email: user.email,
        picture: document.getElementById('picture').value
    };
    localStorage.setItem("coursehub_user", JSON.stringify(updatedUser));
    alert('تم حفظ التغييرات بنجاح!');
    location.reload();
});

// Logout
function logout(){
    localStorage.removeItem("coursehub_user");
    window.location.href = 'login.html';
}
</script>

</body>
</html>
