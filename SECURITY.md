# Security Policy

## Supported Versions

نقوم بدعم أحدث نسخة على الفرع الرئيسي (`main`) فقط حاليًا.

| Version | Supported |
| ------- | --------- |
| main    | ✅        |
| older   | ❌        |

## Reporting a Vulnerability

إذا اكتشفت ثغرة أمنية، الرجاء:

1. عدم نشر تفاصيل الثغرة بشكل علني.
2. فتح بلاغ أمني خاص عبر GitHub Security Advisories (إن كانت مفعّلة) أو مشاركة التفاصيل بشكل مباشر مع مالك المشروع.
3. تضمين خطوات إعادة الإنتاج وتأثير الثغرة.

سنقوم بمراجعة البلاغ والرد في أسرع وقت ممكن.

## Email Deliverability (Firebase + Brevo) — Final Fix Checklist

هذه قائمة عملية نهائية لتحسين وصول رسائل Firebase (تفعيل البريد/إعادة التعيين) وتقليل احتمالية دخولها إلى Spam:

1. **تدوير المفاتيح فورًا عند أي تسريب**
   - غيّر أي مفاتيح SMTP/API مكشوفة في المستودع أو السجلات.
   - ألغِ المفاتيح القديمة وأنشئ مفاتيح جديدة بصلاحيات محدودة.

2. **ضبط SMTP الصحيح لـ Brevo داخل Firebase**
   - استخدم مضيف Brevo الصحيح ومنفذ TLS/STARTTLS المناسب.
   - استخدم مرسلًا من نفس الدومين الذي تم توثيقه في Brevo.

3. **توثيق الدومين بالكامل (SPF + DKIM)**
   - تأكد أن SPF يتضمن Brevo فقط بدون تكرار متعارض.
   - فعّل DKIM وانتظر اكتمال الانتشار DNS ثم تحقق من الحالة “Verified”.

4. **إعداد DMARC تدريجيًا**
   - ابدأ بـ `p=none` مع تقارير.
   - بعد الاستقرار ارفع السياسة تدريجيًا إلى `quarantine` ثم `reject`.

5. **تحقق فعلي من نتائج المصادقة**
   - افحص ترويسات الرسالة (`Authentication-Results`) وتأكد من:
     - `spf=pass`
     - `dkim=pass`
     - `dmarc=pass`

6. **استخدم روابط موثوقة من نفس دومين التطبيق**
   - اجعل روابط التفعيل/إعادة التعيين تشير إلى دومين الموقع الفعلي (وليس دومينًا غريبًا).

7. **راقب السمعة باستمرار**
   - راقب معدلات bounce/complaint/open.
   - نظف القوائم غير النشطة وتجنب الإرسال الكثيف المفاجئ.

> ملاحظة تشغيلية مهمة: لا يوجد حل ثابت يضمن وصولًا 100% دائمًا. أفضل نتيجة تأتي من مزيج: إعدادات DNS صحيحة + إعداد SMTP صحيح + سمعة إرسال جيدة + مراقبة وتحسين مستمر.

## Baseline Hardening Checklist (Applied)

- تم تفعيل تسجيل الدخول وإنشاء الحساب عبر Firebase Authentication بدل التخزين المحلي لكلمات المرور.
- تم إزالة منطق التسجيل المحلي غير الآمن الذي كان يخزن كلمات المرور داخل `localStorage`.
- تم تحسين واجهات تسجيل الدخول/إنشاء الحساب مع رسائل أخطاء واضحة وتحقق أولي من طول كلمة المرور.

## GitHub Repository Protection Recommendations

لا يمكن تقنيًا جعل المستودع "متاحًا لـ Codex فقط" إذا كان Public. لتقييد الوصول:

1. اجعل المستودع **Private**.
2. أضف فقط الحسابات أو GitHub App المصرح لها (Codex integration) بصلاحية **Least Privilege**.
3. فعّل **Branch Protection Rules** للفرع الرئيسي:
   - Require pull request.
   - Require status checks.
   - Restrict who can push.
4. فعّل **Secret Scanning** و **Dependabot alerts**.
5. ألغِ أي Personal Access Token قديم، واستخدم tokens قصيرة الصلاحية.
6. امنع رفع الأسرار عبر `.gitignore` واستخدم GitHub Actions secrets.

> ملاحظة: Codex لا يتجاوز صلاحيات GitHub؛ إذا كان المستودع Private ومقيد الصلاحيات، فلن يتمكن غير المصرح لهم من الوصول.
